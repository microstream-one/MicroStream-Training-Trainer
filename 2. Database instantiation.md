<h1>Database instantiation</h1>

<h2>Target of the unit</h2>

1. Participants should see how easy the usage of MicroStream can be.
2. Should see the basic architecture of MicroStream

<h2>Needed preparations</h2>

1. Any java IDE or text editor
2. Maven installed or available via IDE
3. Annotation Processing enabled in the IDE (Eclipse)
4. GIT installed on the system or available via IDE

<h2>Necessary Links</h2>

1. GIT Repository: https://github.com/ZorgCK/stepbystep-configuration 
2. Branches: 
	* Project configuration: https://github.com/ZorgCK/stepbystep-configuration/tree/1-beginning
	* Configuration file: https://github.com/ZorgCK/stepbystep-configuration/tree/2-projectsetup-done
	* DB Class / Root Class creation: https://github.com/ZorgCK/stepbystep-configuration/tree/3-configurationfile-done
	* Customer Class in Root registration: https://github.com/ZorgCK/stepbystep-configuration/tree/5-create_entity_and_register
	* Creating and Storing a customer: https://github.com/ZorgCK/stepbystep-configuration/tree/6-controller_create_books_done
	* Finale project branch: https://github.com/ZorgCK/stepbystep-configuration/tree/6-controller_create_books_done

<h2>Explanation about the training</h2>

1. Needed preparations see above
2. Duration of the unit
3. Targets of the unit

<h2>PART 1: Project configuration</h2>

**Getting project from GitHub:**
1. `$ git clone https://github.com/ZorgCK/stepbystep-configuration/tree/1-beginning`
2. Or using the GIT functionality of an IDE

**Adding *MicroStream* dependencies to pom.xml**

1. Getting dependencies from https://manual.docs.microstream.one/data-store/getting-started
2. Open pom.xml
3. Adding following dependencies to the dependency section of pom.xml

```xml
	<dependency>
		<groupId>one.microstream</groupId>
		<artifactId>storage.embedded</artifactId>
		<version>04.01.00-MS-GA</version>
	</dependency>
	<dependency>
		<groupId>one.microstream</groupId>
		<artifactId>storage.embedded.configuration</artifactId>
		<version>04.01.00-MS-GA</version>
	</dependency>
```
**Adding *MicroStream* repository to pom.xml**

1. Getting Repository from https://manual.docs.microstream.one/data-store/getting-started
2. Adding following repository to repository section in pom.xml

```xml
	<repository>
		<id>microstream-releases</id>
		<url>
			https://repo.microstream.one/repository/maven-releases/
		</url>
	</repository>
```
<h2>PART 2: Creating configuration file</h2>

1. Create a file called *microstream.xml* at **src/main/resources**
2. Adding the following content to the file

```xml
<properties>
    <property name="baseDirectory" value ="data" />
    <property name="channelCount" value ="4" />
</properties>
```
See https://manual.docs.microstream.one/data-store/configuration/properties for detailed informations to the properties

<h2>PART 3: DB Class / Root Class creation</h2>

**Creating a "ROOT" class**

1. Creating a new class namend "DataRoot" in **src\main\java\one\microstream**
2. Detailed informations to the ROOT is located here: https://manual.docs.microstream.one/data-store/root-instances
3. Lateron the ROOT class will be filled with some more stuff. For this moment an empty class is enought.

**Creating a "Microstream" instance class**

1. Basic informations: https://manual.docs.microstream.one/data-store/root-instances#custom-root-instances
2. Creating a new class named "DB" in **src\main\java\one\microstream**
3. Adding a class variable named "storageManager" from Type "EmbeddedStorageManager"
```java
public static EmbeddedStorageManager	storageManager;
```
5. Adding a class variable named "root" from Type "DataRoot" (Our ROOT class from the topic bevore)
```java
public final static DataRoot	root	= new DataRoot();
```
6. Adding a "static" Block see code below
```java
static
{
	ClassPathResourceLoader loader = new ResourceResolver().getLoader(ClassPathResourceLoader.class).get();
	Optional<URL> resource = loader.getResource("microstream.xml");
	
	storageManager =
		Configuration.LoadXml(resource.get()).createEmbeddedStorageFoundation().createEmbeddedStorageManager(
			root).start();
}
```
